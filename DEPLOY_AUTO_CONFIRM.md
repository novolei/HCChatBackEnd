# ğŸ“ éƒ¨ç½²è„šæœ¬è‡ªåŠ¨ç¡®è®¤åŠŸèƒ½è¯´æ˜

## âœ¨ æ–°åŠŸèƒ½

æ·»åŠ äº† `-y` / `--yes` å‚æ•°ï¼Œæ”¯æŒè‡ªåŠ¨ç¡®è®¤éƒ¨ç½²ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥ Yã€‚

---

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# è‡ªåŠ¨ç¡®è®¤éƒ¨ç½²ï¼ˆæ¨èï¼‰
./deploy.sh chat-gateway -y
./deploy.sh chat-gateway --yes
./deploy.sh message-service -y
./deploy.sh all -y
```

### å¯¹æ¯”ï¼šæ‰‹åŠ¨ç¡®è®¤ vs è‡ªåŠ¨ç¡®è®¤

**æ‰‹åŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼š**
```bash
./deploy.sh chat-gateway

# ä¼šæç¤ºï¼š
# ç¡®è®¤éƒ¨ç½²ï¼Ÿ[Y/n] â–ˆ
# æ˜¯å¦å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼Ÿ[y/N] â–ˆ
```

**è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆ-yï¼‰ï¼š**
```bash
./deploy.sh chat-gateway -y

# è‡ªåŠ¨è·³è¿‡æ‰€æœ‰ç¡®è®¤
# ğŸ¤– è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆ-y/--yesï¼‰
# âœ… ç›´æ¥éƒ¨ç½²ï¼Œä¸éœ€è¦æ‰‹åŠ¨è¾“å…¥
```

---

## ğŸ” åŠŸèƒ½è¯¦æƒ…

### è·³è¿‡çš„ç¡®è®¤æç¤º

1. **éƒ¨ç½²ç¡®è®¤**
   - åŸï¼š`ç¡®è®¤éƒ¨ç½²ï¼Ÿ[Y/n]`
   - ç°ï¼šè‡ªåŠ¨ç¡®è®¤ï¼Œæ˜¾ç¤º `ğŸ¤– è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆ-y/--yesï¼‰`

2. **æ—¥å¿—æŸ¥çœ‹ç¡®è®¤**
   - åŸï¼š`æ˜¯å¦å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼Ÿ[y/N]`
   - ç°ï¼šè‡ªåŠ¨è·³è¿‡ï¼Œä¸æŸ¥çœ‹å®æ—¶æ—¥å¿—

### ä»ç„¶æ˜¾ç¤ºçš„ä¿¡æ¯

âœ… éƒ¨ç½²ä¿¡æ¯ï¼ˆæœåŠ¡åã€VPSã€åˆ†æ”¯ï¼‰  
âœ… Git çŠ¶æ€æ£€æŸ¥  
âœ… éƒ¨ç½²è¿‡ç¨‹è¾“å‡º  
âœ… æœ€è¿‘ 20 æ¡æ—¥å¿—ï¼ˆé™æ€æ˜¾ç¤ºï¼‰  
âœ… éƒ¨ç½²æˆåŠŸ/å¤±è´¥æç¤º  

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èä½¿ç”¨ -yï¼‰
```bash
# ä¿®å¤äº† bugï¼Œå¿«é€Ÿéƒ¨ç½²
./deploy.sh chat-gateway -y

# æ›´æ–°å¤šä¸ªæœåŠ¡
./deploy.sh message-service -y
./deploy.sh chat-gateway -y
```

### ğŸ¤– CI/CD è‡ªåŠ¨åŒ–
```bash
# åœ¨ CI/CD è„šæœ¬ä¸­ä½¿ç”¨
./deploy.sh all -y
```

### ğŸ‘€ è°¨æ…éƒ¨ç½²ï¼ˆä½¿ç”¨æ‰‹åŠ¨ç¡®è®¤ï¼‰
```bash
# é‡è¦æ›´æ–°ï¼Œéœ€è¦å†æ¬¡ç¡®è®¤
./deploy.sh chat-gateway

# ä¼šæç¤ºç¡®è®¤ï¼Œé¿å…è¯¯æ“ä½œ
```

---

## ğŸ“‹ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šè‡ªåŠ¨éƒ¨ç½² chat-gateway

```bash
cd /Users/ryanliu/DDCS/HChat/HCChatBackEnd
./deploy.sh chat-gateway -y
```

**è¾“å‡ºï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸš€ HChat Backend éƒ¨ç½²å·¥å…·           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ éƒ¨ç½²ä¿¡æ¯:
   æœåŠ¡:   chat-gateway
   VPS:    root@mx.go-lv.com
   åˆ†æ”¯:   main

ğŸ¤– è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆ-y/--yesï¼‰

[19:58:02] æ£€æŸ¥ Git çŠ¶æ€...
âœ… Git çŠ¶æ€æ­£å¸¸
âš ï¸  è·³è¿‡æäº¤æ­¥éª¤
[19:58:02] è¿æ¥ VPS: root@mx.go-lv.com...
ğŸ“¦ åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•...
ğŸ” æ£€æŸ¥æœ¬åœ°çŠ¶æ€...
ğŸ”„ æ‹‰å–æœ€æ–°ä»£ç ...
ğŸ³ è¿›å…¥ Docker ç›®å½•...
ğŸ”„ é‡å¯æœåŠ¡: chat-gateway...
 Container infra-chat-gateway-1  Restarting
 Container infra-chat-gateway-1  Started

âœ… éƒ¨ç½²å®Œæˆï¼

ğŸ“Š æœ€è¿‘ 20 æ¡æ—¥å¿—:
chat-gateway-1  | chat-gateway listening on 8080
...

âœ… VPS éƒ¨ç½²æˆåŠŸ

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ‰ éƒ¨ç½²æˆåŠŸï¼                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ç¤ºä¾‹ 2ï¼šæ‰¹é‡éƒ¨ç½²å¤šä¸ªæœåŠ¡

```bash
#!/bin/bash
# deploy-all-services.sh

cd /Users/ryanliu/DDCS/HChat/HCChatBackEnd

echo "ğŸš€ å¼€å§‹æ‰¹é‡éƒ¨ç½²..."

./deploy.sh chat-gateway -y
./deploy.sh message-service -y

echo "âœ… æ‰€æœ‰æœåŠ¡éƒ¨ç½²å®Œæˆï¼"
```

---

## âš™ï¸ æŠ€æœ¯å®ç°

### æ–°å¢é…ç½®å˜é‡

```bash
AUTO_CONFIRM=false  # æ˜¯å¦è‡ªåŠ¨ç¡®è®¤
```

### å‚æ•°è§£æ

```bash
# è§£æå‰©ä½™å‚æ•°ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ -y æˆ– --yes
shift  # è·³è¿‡ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæœåŠ¡åï¼‰
while [[ $# -gt 0 ]]; do
    case "$1" in
        -y|--yes)
            AUTO_CONFIRM=true
            ;;
        *)
            commit_msg="$1"
            ;;
    esac
    shift
done
```

### ç¡®è®¤é€»è¾‘

```bash
# éƒ¨ç½²ç¡®è®¤
if [[ "$AUTO_CONFIRM" != true ]]; then
    read -p "ç¡®è®¤éƒ¨ç½²ï¼Ÿ[Y/n] " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Nn]$ ]]; then
        print_warning "éƒ¨ç½²å·²å–æ¶ˆ"
        exit 0
    fi
else
    echo "ğŸ¤– è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆ-y/--yesï¼‰"
    echo ""
fi
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# æ˜¾ç¤ºéƒ¨ç½²åçš„æ—¥å¿—
show_logs() {
    local service="$1"
    
    if [[ "$service" == "all" || "$service" == "config" ]]; then
        return
    fi
    
    # å¦‚æœè‡ªåŠ¨ç¡®è®¤ï¼Œç›´æ¥è·³è¿‡æ—¥å¿—æŸ¥çœ‹
    if [[ "$AUTO_CONFIRM" == true ]]; then
        return
    fi
    
    echo ""
    read -p "æ˜¯å¦å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼Ÿ[y/N] " -n 1 -r
    ...
}
```

---

## ğŸ”„ æ›´æ–°æ—¥å¿—

### 2025-10-21

**ç‰ˆæœ¬ 1ï¼šåˆå§‹å®ç°**
- âœ… æ·»åŠ  `-y` / `--yes` å‚æ•°æ”¯æŒ
- âœ… è·³è¿‡æ—¥å¿—æŸ¥çœ‹ç¡®è®¤

**ç‰ˆæœ¬ 2ï¼šå®Œå–„åŠŸèƒ½**
- âœ… è·³è¿‡éƒ¨ç½²ç¡®è®¤æç¤º
- âœ… æ˜¾ç¤ºè‡ªåŠ¨ç¡®è®¤æ¨¡å¼æç¤º
- âœ… æ›´æ–°ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²è„šæœ¬è¯´æ˜](README.md)
- [æœåŠ¡ç®¡ç†æŒ‡å—](SERVICES.md)
- [æ•…éšœæ’æŸ¥](TROUBLESHOOTING.md)
- [æœ€ä½³å®è·µ](DEPLOYMENT_BEST_PRACTICES.md)

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

| å‘½ä»¤ | è¯´æ˜ | äº¤äº’ |
|------|------|------|
| `./deploy.sh chat-gateway` | æ‰‹åŠ¨ç¡®è®¤éƒ¨ç½² | éœ€è¦è¾“å…¥ Y |
| `./deploy.sh chat-gateway -y` | è‡ªåŠ¨ç¡®è®¤éƒ¨ç½² | æ— éœ€è¾“å…¥ âœ… |
| `./deploy.sh chat-gateway --yes` | è‡ªåŠ¨ç¡®è®¤éƒ¨ç½²ï¼ˆé•¿æ ¼å¼ï¼‰ | æ— éœ€è¾“å…¥ âœ… |
| `./deploy.sh all -y` | è‡ªåŠ¨éƒ¨ç½²æ‰€æœ‰æœåŠ¡ | æ— éœ€è¾“å…¥ âœ… |

---

**ç°åœ¨éƒ¨ç½²æ›´å¿«æ›´æ–¹ä¾¿äº†ï¼** ğŸš€

